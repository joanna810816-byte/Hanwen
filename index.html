<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>æ²–ç¹©ä¹‹æ—… Okinawa 2026</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;700&display=swap" rel="stylesheet">

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        milk: {
                            50: '#FDFBF7',
                            100: '#F5EFE0',
                            200: '#EBDCB2',
                            300: '#DCC28E',
                            400: '#C19A6B',
                            500: '#A67B5B',
                            600: '#8C6B3D',
                            900: '#4A3B2A',
                        }
                    },
                    fontFamily: {
                        sans: ['Noto Sans TC', 'sans-serif'],
                    }
                }
            }
        }
    </script>
    <style>
        body {
            background-color: #FDFBF7;
            -webkit-tap-highlight-color: transparent;
            min-height: 100vh;
        }
        .hide-scrollbar::-webkit-scrollbar { display: none; }
        .hide-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        .tab-content { display: none; animation: fadeIn 0.3s ease-in-out; }
        .tab-content.active { display: block; }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .timeline-line {
            position: absolute; left: 1.25rem; top: 0; bottom: 0; width: 2px; background-color: #EBDCB2; z-index: 0;
        }
        .timeline-container { position: relative; padding-left: 0; }
        
        /* Checkbox Custom Style */
        .custom-checkbox:checked + div { background-color: #C19A6B; border-color: #C19A6B; }
        .custom-checkbox:checked + div svg { display: block; }

        /* Modal */
        .modal-backdrop {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background-color: rgba(0, 0, 0, 0.5); z-index: 50;
            display: none; justify-content: center; align-items: center;
        }
        .modal-content {
            background-color: #FDFBF7; border-radius: 1rem; padding: 1.5rem;
            width: 90%; max-width: 450px; box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }
        
        /* Weather Loading Animation */
        @keyframes pulse-sky {
            0%, 100% { background-color: #EFF6FF; }
            50% { background-color: #DBEAFE; }
        }
        .weather-loading { animation: pulse-sky 2s cubic-bezier(0.4, 0, 0.6, 1) infinite; }
    </style>
</head>
<body class="text-milk-900 font-sans">

    <header class="bg-milk-100 px-6 pt-12 pb-4 shadow-sm sticky top-0 z-40">
        <div class="flex justify-between items-center">
            <div>
                <p class="text-milk-500 text-sm font-medium mb-1">2026 Spring Trip</p>
                <h1 class="text-2xl font-bold text-milk-600">Okinawa æ²–ç¹© ğŸŒº</h1>
            </div>
            <div class="bg-milk-400 text-white px-3 py-1 rounded-full text-xs font-bold shadow-sm" onclick="resetAllData()">
                5 Days
            </div>
        </div>
    </header>

    <main class="p-5 pb-36" id="main-content">
        
        <section id="tab-flight" class="tab-content">
            <h2 class="text-lg font-bold mb-4 text-milk-600 border-l-4 border-milk-400 pl-3">èˆªç­è³‡è¨Š</h2>
            
            <div class="bg-white rounded-2xl p-5 shadow-sm mb-4 border border-milk-100 relative overflow-hidden">
                <div class="absolute top-0 right-0 bg-milk-200 w-16 h-16 rounded-bl-full -mr-8 -mt-8 opacity-20"></div>
                <div class="flex justify-between items-center mb-3">
                    <span class="bg-milk-100 text-milk-600 text-xs px-2 py-1 rounded font-bold">å»ç¨‹ 2026/04/14</span>
                    <span class="font-bold text-lg text-milk-500">IT230</span>
                </div>
                <div class="flex justify-between items-center text-center">
                    <div>
                        <div class="text-2xl font-bold text-milk-900">06:50</div>
                        <div class="text-xs text-gray-400">TPE å°åŒ—æ¡ƒåœ’</div>
                    </div>
                    <div class="text-milk-300 flex flex-col items-center px-2">
                        <i class="fa-solid fa-plane text-xl transform -rotate-45"></i>
                        <span class="text-[10px] mt-1 text-milk-400">Tigerair</span>
                    </div>
                    <div>
                        <div class="text-2xl font-bold text-milk-900">09:20</div>
                        <div class="text-xs text-gray-400">OKA é‚£éœ¸</div>
                    </div>
                </div>
            </div>

            <div class="bg-white rounded-2xl p-5 shadow-sm mb-6 border border-milk-100 relative overflow-hidden">
                <div class="absolute top-0 right-0 bg-milk-200 w-16 h-16 rounded-bl-full -mr-8 -mt-8 opacity-20"></div>
                <div class="flex justify-between items-center mb-3">
                    <span class="bg-milk-100 text-milk-600 text-xs px-2 py-1 rounded font-bold">å›ç¨‹ 2026/04/18</span>
                    <span class="font-bold text-lg text-milk-500">CI133</span>
                </div>
                <div class="flex justify-between items-center text-center">
                    <div>
                        <div class="text-2xl font-bold text-milk-900">19:45</div>
                        <div class="text-xs text-gray-400">OKA é‚£éœ¸</div>
                    </div>
                    <div class="text-milk-300 flex flex-col items-center px-2">
                        <i class="fa-solid fa-plane text-xl transform -rotate-45"></i>
                        <span class="text-[10px] mt-1 text-milk-400">China Airlines</span>
                    </div>
                    <div>
                        <div class="text-2xl font-bold text-milk-900">20:35</div>
                        <div class="text-xs text-gray-400">KHH é«˜é›„å°æ¸¯</div>
                    </div>
                </div>
            </div>

            <div class="mb-8">
                <h3 class="text-md font-bold mb-3 text-milk-600 flex items-center">
                    <i class="fa-solid fa-passport mr-2"></i>å…¥å¢ƒæº–å‚™
                </h3>
                <div class="bg-white rounded-2xl p-4 shadow-sm border border-milk-100">
                    <a href="https://www.vjw.digital.go.jp/" target="_blank" class="flex items-center justify-between bg-milk-100 text-milk-600 p-3 rounded-xl mb-3 hover:bg-milk-200 transition font-bold">
                        <span class="text-sm"><i class="fa-solid fa-link mr-2"></i>é–‹å•Ÿ Visit Japan Web</span>
                        <i class="fa-solid fa-chevron-right text-xs"></i>
                    </a>
                    
                    <div class="border-2 border-dashed border-milk-300 rounded-xl p-4 flex flex-col items-center justify-center text-milk-400 bg-milk-50 cursor-pointer" onclick="document.getElementById('qr-upload').click()">
                        <i class="fa-solid fa-qrcode text-3xl mb-2"></i>
                        <p class="text-xs font-bold">é»æ“Šä¸Šå‚³ VJW QR Code æˆªåœ–</p>
                        <p class="text-[10px] opacity-70">æ–¹ä¾¿é›¢ç·šæ™‚æŸ¥çœ‹ (åƒ…å­˜æ–¼æœ¬åœ°)</p>
                        <input type="file" id="qr-upload" class="hidden" accept="image/*" onchange="handleQrUpload(this)">
                    </div>
                    <div id="qr-preview" class="hidden mt-3 text-center">
                        <img id="qr-image" src="" class="max-w-full rounded-lg shadow-sm mx-auto max-h-64 object-contain">
                        <button onclick="removeQr()" class="text-xs text-red-400 mt-2 underline">ç§»é™¤åœ–ç‰‡</button>
                    </div>
                </div>
            </div>

            <div class="mb-4">
                <h3 class="text-md font-bold mb-3 text-milk-600 flex items-center">
                    <i class="fa-solid fa-clipboard-check mr-2"></i>è¡Œææ¸…å–®
                </h3>
                <div class="flex gap-2 mb-4">
                    <input type="text" id="checklist-input" placeholder="æ–°å¢å¾…è¾¦äº‹é …..." class="flex-1 bg-white border border-milk-200 rounded-xl px-4 py-2 text-sm focus:outline-none focus:border-milk-400">
                    <button onclick="addChecklistItem()" class="bg-milk-400 text-white w-10 h-10 rounded-xl shadow-sm active:scale-95 transition flex items-center justify-center">
                        <i class="fa-solid fa-plus"></i>
                    </button>
                </div>
                <div id="checklist-container" class="space-y-2">
                    </div>
            </div>
        </section>

        <section id="tab-hotel" class="tab-content">
            <h2 class="text-lg font-bold mb-4 text-milk-600 border-l-4 border-milk-400 pl-3">ä½å®¿è³‡è¨Š</h2>
            
            <div class="bg-white rounded-2xl overflow-hidden shadow-sm mb-5 border border-milk-100">
                <div class="h-32 bg-gray-200 relative">
                    <div class="absolute inset-0 bg-milk-300 flex items-center justify-center text-white">
                        <i class="fa-solid fa-bed text-4xl opacity-50"></i>
                    </div>
                    <div class="absolute bottom-2 left-2 bg-milk-400/80 text-white text-xs px-2 py-1 rounded backdrop-blur-sm">Day 1-2 (ç¾åœ‹æ‘)</div>
                </div>
                <div class="p-5">
                    <h3 class="font-bold text-lg text-milk-900 leading-tight">Lapin Mihama Residence Hotel</h3>
                    <p class="text-sm text-gray-500 mt-2">**å…¥ä½:** 2026/04/14 - **é€€æˆ¿:** 2026/04/16</p>
                    <p class="text-xs text-milk-500 font-mono mt-2 bg-milk-50 inline-block px-2 py-1 rounded">ç¢ºèªè™Ÿ: 20251101204316</p>
                    <div class="mt-3">
                        <input type="text" id="hotel-note-1" oninput="saveHotelNotes()" placeholder="è¼¸å…¥å‚™è¨» (ä¾‹å¦‚: åœè»Šä½è™Ÿç¢¼...)" class="w-full bg-milk-50 border border-milk-100 rounded px-2 py-1 text-sm focus:outline-none focus:border-milk-300 placeholder-gray-300">
                    </div>
                    <div class="mt-4 flex gap-2">
                        <a href="https://www.google.com/maps/search/?api=1&query=Lapin+Mihama+Residence+Hotel" target="_blank" class="flex-1 bg-milk-100 hover:bg-milk-200 text-milk-600 py-2 rounded-lg text-sm font-medium text-center transition">
                            <i class="fa-solid fa-location-dot mr-1"></i> Google Map
                        </a>
                    </div>
                </div>
            </div>

            <div class="bg-white rounded-2xl overflow-hidden shadow-sm border border-milk-100">
                <div class="h-32 relative">
                    <div class="absolute inset-0 bg-gradient-to-br from-milk-300 to-milk-400 flex items-center justify-center text-white">
                        <i class="fa-solid fa-city text-4xl opacity-70"></i>
                    </div>
                    <div class="absolute bottom-2 left-2 bg-milk-400/80 text-white text-xs px-2 py-1 rounded backdrop-blur-sm">
                        Day 3-4 (é‚£éœ¸å¸‚å€)
                    </div>
                </div>
                <div class="p-5">
                    <h3 class="font-bold text-lg text-milk-900 leading-tight">æ±æ€¥STAYæ²–ç¹©é‚£éœ¸</h3>
                     <p class="text-sm text-gray-500 mt-2">
                        **å…¥ä½:** 2026/04/16 - **é€€æˆ¿:** 2026/04/18
                    </p>
                    <p class="text-xs text-milk-500 font-mono mt-2 bg-milk-50 inline-block px-2 py-1 rounded">ç¢ºèªè™Ÿ: 1128144023379653</p>
                    <div class="mt-3">
                        <input type="text" id="hotel-note-2" oninput="saveHotelNotes()" placeholder="è¼¸å…¥å‚™è¨» (ä¾‹å¦‚: æ—©é¤æ™‚é–“...)" class="w-full bg-milk-50 border border-milk-100 rounded px-2 py-1 text-sm focus:outline-none focus:border-milk-300 placeholder-gray-300">
                    </div>
                    <div class="mt-4 flex gap-2">
                        <a href="https://www.google.com/maps/search/?api=1&query=Tokyu+Stay+Okinawa+Naha" target="_blank" class="flex-1 bg-milk-100 hover:bg-milk-200 text-milk-600 py-2 rounded-lg text-sm font-medium text-center transition">
                            <i class="fa-solid fa-location-dot mr-1"></i> Google Map
                        </a>
                    </div>
                </div>
            </div>
        </section>

        <section id="tab-itinerary" class="tab-content active">
            <h2 class="text-lg font-bold mb-4 text-milk-600 border-l-4 border-milk-400 pl-3">è¡Œç¨‹è¦åŠƒèˆ‡ç®¡ç†</h2>
            
            <div class="flex items-center gap-2 mb-4">
                <div class="flex overflow-x-auto space-x-2 pb-2 hide-scrollbar flex-1">
                    <button onclick="filterDay(1)" class="day-filter active bg-milk-400 text-white px-4 py-1.5 rounded-full text-sm font-bold shadow-md whitespace-nowrap transition flex-shrink-0" data-day="1">Day 1</button>
                    <button onclick="filterDay(2)" class="day-filter bg-white text-milk-500 border border-milk-200 px-4 py-1.5 rounded-full text-sm font-medium whitespace-nowrap transition flex-shrink-0" data-day="2">Day 2</button>
                    <button onclick="filterDay(3)" class="day-filter bg-white text-milk-500 border border-milk-200 px-4 py-1.5 rounded-full text-sm font-medium whitespace-nowrap transition flex-shrink-0" data-day="3">Day 3</button>
                    <button onclick="filterDay(4)" class="day-filter bg-white text-milk-500 border border-milk-200 px-4 py-1.5 rounded-full text-sm font-medium whitespace-nowrap transition flex-shrink-0" data-day="4">Day 4</button>
                    <button onclick="filterDay(5)" class="day-filter bg-white text-milk-500 border border-milk-200 px-4 py-1.5 rounded-full text-sm font-medium whitespace-nowrap transition flex-shrink-0" data-day="5">Day 5</button>
                </div>
                <div id="weather-widget" class="flex-shrink-0 flex items-center justify-center px-3 py-1 bg-blue-50 border border-blue-100 rounded-2xl shadow-sm h-9 weather-loading min-w-[110px]">
                     <div class="flex items-center gap-2 text-blue-500 text-xs font-bold">
                        <i class="fa-solid fa-spinner fa-spin"></i> <span>è¼‰å…¥ä¸­...</span>
                     </div>
                </div>
            </div>

            <button onclick="openItineraryModal('add')" class="w-full bg-milk-100 hover:bg-milk-200 text-milk-600 py-3 rounded-xl font-bold transition shadow-sm text-sm mb-6">
                <i class="fa-solid fa-plus-circle mr-1"></i> å¢åŠ è¡Œç¨‹
            </button>

            <div class="timeline-container" id="itinerary-list">
                </div>
        </section>

        <section id="tab-rate" class="tab-content">
            <h2 class="text-lg font-bold mb-4 text-milk-600 border-l-4 border-milk-400 pl-3">åŒ¯ç‡æ›ç®—</h2>
            <div class="max-w-sm mx-auto bg-white p-6 rounded-2xl shadow-sm mb-6 border border-milk-100">
                <div class="mb-5">
                    <label class="block text-xs font-bold text-gray-400 mb-1 ml-1">ç•¶å‰åŒ¯ç‡</label>
                    <div class="relative">
                        <input type="number" id="rate-input" step="0.001" value="0.22" class="w-full bg-milk-50 border border-milk-200 rounded-lg py-2 px-3 text-center font-bold text-milk-600 focus:outline-none" oninput="saveRate(); calculateRate(); renderAccountingSummary();">
                        <span class="absolute right-3 top-2 text-xs text-gray-400 mt-0.5">JPY/TWD</span>
                    </div>
                </div>
                <div class="space-y-4">
                    <div class="w-full">
                        <label class="block text-xs font-bold text-milk-500 mb-1 ml-1">æ—¥å¹£é‡‘é¡ (JPY)</label>
                        <input type="number" id="jpy-input" class="w-full bg-milk-50 border border-milk-200 rounded-xl py-3 px-4 font-bold text-xl" placeholder="è¼¸å…¥é‡‘é¡" oninput="calculateRate('jpy')">
                    </div>
                    <div class="flex justify-center -my-2 relative z-10"><i class="fa-solid fa-arrow-down text-milk-300 bg-white p-1 rounded-full border border-milk-100"></i></div>
                    <div class="w-full">
                        <label class="block text-xs font-bold text-milk-500 mb-1 ml-1">æ–°å°å¹£é‡‘é¡ (TWD)</label>
                        <input type="number" id="twd-input" class="w-full bg-milk-100 border border-milk-200 rounded-xl py-3 px-4 font-bold text-xl text-milk-600" readonly placeholder="0">
                    </div>
                </div>
                <button onclick="document.getElementById('jpy-input').value=''; document.getElementById('twd-input').value=''; " class="w-full mt-6 bg-milk-400 text-white py-3 rounded-xl font-bold transition shadow-sm text-sm">æ¸…é™¤é‡ç®—</button>
            </div>
        </section>

        <section id="tab-account" class="tab-content">
            <h2 class="text-lg font-bold mb-4 text-milk-600 border-l-4 border-milk-400 pl-3">æ—…éŠè¨˜å¸³</h2>

            <div id="summary-card" class="bg-milk-400 rounded-2xl p-5 text-white shadow-md mb-6 relative overflow-hidden">
                <div class="relative z-10">
                    <p class="text-xs opacity-90">ç¸½èŠ±è²»æ¦‚ç®— (ä»¥ç•¶å‰åŒ¯ç‡æ›ç®—)</p>
                    <h3 class="text-4xl font-bold mt-1" id="total-twd">0 TWD</h3>
                </div>
                <p class="text-sm opacity-90 text-right mt-2" id="total-jpy">JPY ç¸½é¡: 0</p>
                <i class="fa-solid fa-coins absolute -right-4 -bottom-4 text-6xl opacity-20 text-white"></i>
            </div>

            <div class="bg-white rounded-2xl p-5 shadow-lg border border-milk-100 mb-6">
                <h3 class="text-md font-bold mb-4 text-milk-600 flex items-center"><i class="fa-solid fa-plus-circle mr-2"></i>æ–°å¢èŠ±è²»</h3>
                <form id="add-expense-form" onsubmit="addExpense(event)">
                    <label class="block text-xs font-bold text-milk-500 mb-1 ml-1">é …ç›®åç¨±</label>
                    <input type="text" id="expense-name" placeholder="ä¾‹å¦‚: åˆé¤, æ°´æ—é¤¨é–€ç¥¨" class="w-full bg-milk-50 border border-milk-200 rounded-lg py-2 px-3 text-sm focus:outline-none focus:border-milk-400 mb-4" required>
                    <div class="flex gap-4 mb-4">
                        <div class="flex-1">
                            <label class="block text-xs font-bold text-milk-500 mb-1 ml-1">é‡‘é¡ (JPY)</label>
                            <input type="number" id="expense-amount-jpy" placeholder="5000" class="w-full bg-milk-50 border border-milk-200 rounded-lg py-2 px-3 text-sm focus:outline-none focus:border-milk-400" required>
                        </div>
                        <div class="flex-1">
                            <label class="block text-xs font-bold text-milk-500 mb-1 ml-1">é¡åˆ¥</label>
                            <select id="expense-category" class="w-full bg-milk-50 border border-milk-200 rounded-lg py-2 px-3 text-sm focus:outline-none focus:border-milk-400">
                                <option value="é¤é£²">é¤é£²</option>
                                <option value="é–€ç¥¨">é–€ç¥¨</option>
                                <option value="è³¼ç‰©">è³¼ç‰©</option>
                                <option value="äº¤é€š">äº¤é€š</option>
                                <option value="ä½å®¿">ä½å®¿</option>
                                <option value="å…¶ä»–">å…¶ä»–</option>
                            </select>
                        </div>
                    </div>
                    <button type="submit" class="w-full bg-milk-400 hover:bg-milk-500 text-white py-3 rounded-xl font-bold transition shadow-sm text-sm">
                        <i class="fa-solid fa-circle-plus mr-1"></i> è¨˜éŒ„é€™ç­†èŠ±è²»
                    </button>
                </form>
            </div>
            
            <h3 class="text-md font-bold mt-8 mb-3 text-milk-600 flex items-center"><i class="fa-solid fa-list-ul mr-2"></i>è©³ç´°æ¸…å–®</h3>
            <div id="expense-list-container">
                </div>
        </section>

        <section id="tab-emergency" class="tab-content">
             <h2 class="text-lg font-bold mb-4 text-red-400 border-l-4 border-red-400 pl-3">ç·Šæ€¥å”åŠ©</h2>
             <div class="grid grid-cols-2 gap-4 mb-6">
                 <a href="tel:119" class="bg-white p-4 rounded-2xl shadow-sm border border-red-100 flex flex-col items-center justify-center gap-2 active:bg-red-50 hover:shadow-md transition">
                     <div class="w-12 h-12 bg-red-100 rounded-full flex items-center justify-center text-red-500 text-xl"><i class="fa-solid fa-truck-medical"></i></div>
                     <span class="font-bold text-gray-700">å«æ•‘è­·è»Š</span>
                     <span class="text-xs text-gray-400">æ’¥æ‰“ 119</span>
                 </a>
                 <a href="tel:110" class="bg-white p-4 rounded-2xl shadow-sm border border-blue-100 flex flex-col items-center justify-center gap-2 active:bg-blue-50 hover:shadow-md transition">
                     <div class="w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center text-blue-500 text-xl"><i class="fa-solid fa-user-shield"></i></div>
                     <span class="font-bold text-gray-700">å ±è­¦</span>
                     <span class="text-xs text-gray-400">æ’¥æ‰“ 110</span>
                 </a>
             </div>
             <div class="bg-white rounded-2xl p-5 shadow-sm border border-red-100 mb-4">
                <h3 class="font-bold text-red-500 mb-2 text-sm flex items-center">
                    <i class="fa-solid fa-hospital mr-2"></i>24å°æ™‚-å°±è¿‘æ€¥è¨º
                </h3>
                <p class="font-bold text-gray-800 mb-1 leading-tight">é‚£éœ¸å¸‚ç«‹é†«é™¢</p>
                <p class="text-xs text-gray-500 mb-3">åœ°å€: æ²–ç¹©ç¸£é‚£éœ¸å¸‚å¤å³¶2-31-1</p>
                <div class="flex flex-col gap-2">
                    <a href="tel:0988845111" class="flex items-center gap-3 text-red-600 bg-red-50 p-3 rounded-lg hover:bg-red-100 transition">
                        <i class="fa-solid fa-phone"></i><span class="font-bold text-sm">é›»è©±: 098-884-5111</span>
                    </a>
                    <a href="https://maps.app.goo.gl/NahaCityHospitalPlaceholder" target="_blank" class="flex items-center gap-3 text-milk-600 bg-milk-50 p-3 rounded-lg hover:bg-milk-100 transition">
                        <i class="fa-solid fa-map-location-dot"></i><span class="font-bold text-sm">é–‹å•Ÿåœ°åœ–å°èˆª</span>
                    </a>
                </div>
            </div>
             <div class="bg-white rounded-2xl p-5 shadow-sm border border-milk-100 mb-4">
                 <h3 class="font-bold text-gray-800 mb-2 text-sm">å°åŒ—é§æ—¥ç¶“æ¿Ÿæ–‡åŒ–ä»£è¡¨è™• (é‚£éœ¸)</h3>
                 <p class="text-xs text-gray-500 mb-3">è­·ç…§éºå¤±ã€æ€¥é›£æ•‘åŠ©</p>
                 <a href="https://goo.gl/maps/PlaceHolder" target="_blank" class="flex items-center gap-3 text-milk-600 bg-milk-50 p-3 rounded-lg hover:bg-milk-100 transition">
                     <i class="fa-solid fa-map-location-dot"></i><span class="font-bold text-sm">é–‹å•Ÿåœ°åœ–å°èˆª</span>
                 </a>
                 <a href="tel:+81-98-862-7008" class="flex items-center gap-3 text-milk-600 bg-milk-50 p-3 rounded-lg mt-2 hover:bg-milk-100 transition">
                     <i class="fa-solid fa-phone"></i><span class="font-bold text-sm">098-862-7008</span>
                 </a>
             </div>
             <div class="bg-white rounded-2xl p-5 shadow-sm border border-milk-100 mb-4">
                <h3 class="font-bold text-milk-600 mb-2 text-sm flex items-center">
                    <i class="fa-solid fa-laptop-medical mr-2"></i>ç·šä¸Šé†«ç™‚æ”¯æ´
                </h3>
                <p class="text-xs text-gray-500 mb-3">è¨ªæ—¥æ—…éŠæœŸé–“çš„ç·šä¸Šæ—¥èª/ä¸­æ–‡é†«ç”Ÿè«®è©¢æœå‹™</p>
                <a href="https://oh-doctor.com/zh-tw/oh-traveler-dr-tw/" target="_blank" class="flex items-center gap-3 text-milk-600 bg-milk-100 p-3 rounded-lg hover:bg-milk-200 transition">
                    <i class="fa-solid fa-link"></i><span class="font-bold text-sm">æ—¥æœ¬ç·šä¸Šé†«ç”Ÿè¨ªæ—¥é†«ç™‚æ”¯æ´æ–¹æ¡ˆ</span><i class="fa-solid fa-chevron-right ml-auto text-xs"></i>
                </a>
            </div>
        </section>

    </main>

    <div id="itinerary-modal" class="modal-backdrop transition-opacity duration-300 opacity-0 pointer-events-none">
        <div class="modal-content">
            <h3 class="text-lg font-bold text-milk-600 mb-4" id="modal-title">æ–°å¢è¡Œç¨‹</h3>
            <form id="itinerary-form">
                <input type="hidden" id="itinerary-id"><input type="hidden" id="itinerary-day">
                <label class="block text-xs font-bold text-milk-500 mb-1 ml-1">è¡Œç¨‹åç¨±</label>
                <input type="text" id="item-name" placeholder="ä¾‹å¦‚: åœ‹éš›é€šè³¼ç‰©" class="w-full bg-milk-50 border border-milk-200 rounded-lg py-2 px-3 text-sm mb-3" required>
                <div class="flex gap-3 mb-3">
                    <div class="w-1/2">
                        <label class="block text-xs font-bold text-milk-500 mb-1 ml-1">æ™‚é–“</label>
                        <input type="time" id="item-time" class="w-full bg-milk-50 border border-milk-200 rounded-lg py-2 px-3 text-sm" required>
                    </div>
                    <div class="w-1/2">
                        <label class="block text-xs font-bold text-milk-500 mb-1 ml-1">åœ–ç¤ºé¡å‹</label>
                        <select id="item-icon" class="w-full bg-milk-50 border border-milk-200 rounded-lg py-2 px-3 text-sm">
                            <option value="fa-plane">é£›æ©Ÿ âœˆï¸</option>
                            <option value="fa-car-side">ç§Ÿè»Š/äº¤é€š ğŸš—</option>
                            <option value="fa-utensils">é¤é£² ğŸ´</option>
                            <option value="fa-camera">æ™¯é» ğŸ“·</option>
                            <option value="fa-cart-shopping">è³¼ç‰© ğŸ›’</option>
                            <option value="fa-bed">ä½å®¿ ğŸ›ï¸</option>
                        </select>
                    </div>
                </div>
                <label class="block text-xs font-bold text-milk-500 mb-1 ml-1">åœ°åœ–é—œéµå­—</label>
                <input type="text" id="item-location" placeholder="åœ°æ¨™åç¨± (å°èˆªç”¨)" class="w-full bg-milk-50 border border-milk-200 rounded-lg py-2 px-3 text-sm mb-3" required>
                <label class="block text-xs font-bold text-milk-500 mb-1 ml-1">è¡Œç¨‹å‚™è¨»</label>
                <textarea id="item-notes" placeholder="æ³¨æ„äº‹é …..." class="w-full bg-milk-50 border border-milk-200 rounded-lg py-2 px-3 text-sm h-20"></textarea>
                <div class="flex gap-3 mt-4">
                    <button type="button" onclick="closeItineraryModal()" class="flex-1 bg-gray-200 hover:bg-gray-300 text-gray-700 py-2 rounded-xl font-bold transition text-sm">å–æ¶ˆ</button>
                    <button type="submit" class="flex-1 bg-milk-400 hover:bg-milk-500 text-white py-2 rounded-xl font-bold transition text-sm" id="modal-submit-btn">å„²å­˜</button>
                </div>
            </form>
        </div>
    </div>

    <nav class="bg-white border-t border-milk-200 pb-safe px-2 fixed bottom-0 w-full z-50 h-24 shadow-[0_-4px_6px_-1px_rgba(0,0,0,0.05)]">
        <div class="grid grid-cols-6 gap-1 h-[80px] pt-2">
            <button onclick="switchTab('flight')" class="nav-btn flex flex-col items-center justify-center text-gray-400 hover:text-milk-500" data-target="tab-flight">
                <div class="w-10 h-8 rounded-xl flex items-center justify-center mb-1 transition-colors"><i class="fa-solid fa-plane-departure text-xl"></i></div><span class="text-[10px] scale-90">èˆªç­</span>
            </button>
            <button onclick="switchTab('hotel')" class="nav-btn flex flex-col items-center justify-center text-gray-400 hover:text-milk-500" data-target="tab-hotel">
                <div class="w-10 h-8 rounded-xl flex items-center justify-center mb-1 transition-colors"><i class="fa-solid fa-hotel text-xl"></i></div><span class="text-[10px] scale-90">é£¯åº—</span>
            </button>
            <button onclick="switchTab('itinerary')" class="nav-btn flex flex-col items-center justify-center text-milk-600 font-bold" data-target="tab-itinerary">
                <div class="w-10 h-8 rounded-xl flex items-center justify-center mb-1 transition-colors bg-milk-100"><i class="fa-solid fa-map-location-dot text-xl"></i></div><span class="text-[10px] scale-90">è¡Œç¨‹</span>
            </button>
            <button onclick="switchTab('rate')" class="nav-btn flex flex-col items-center justify-center text-gray-400 hover:text-milk-500" data-target="tab-rate">
                <div class="w-10 h-8 rounded-xl flex items-center justify-center mb-1 transition-colors"><i class="fa-solid fa-money-bill-transfer text-xl"></i></div><span class="text-[10px] scale-90">åŒ¯ç‡</span>
            </button>
            <button onclick="switchTab('account')" class="nav-btn flex flex-col items-center justify-center text-gray-400 hover:text-milk-500" data-target="tab-account">
                <div class="w-10 h-8 rounded-xl flex items-center justify-center mb-1 transition-colors"><i class="fa-solid fa-calculator text-xl"></i></div><span class="text-[10px] scale-90">è¨˜å¸³</span>
            </button>
            <button onclick="switchTab('emergency')" class="nav-btn flex flex-col items-center justify-center text-gray-400 hover:text-milk-500" data-target="tab-emergency">
                <div class="w-10 h-8 rounded-xl flex items-center justify-center mb-1 transition-colors"><i class="fa-solid fa-kit-medical text-xl"></i></div><span class="text-[10px] scale-90">é†«ç™‚</span>
            </button>
        </div>
    </nav>

    <script>
        // --- Tab Logic ---
        function switchTab(tabId) {
            document.querySelectorAll('.tab-content').forEach(el => el.classList.remove('active'));
            document.getElementById('tab-' + tabId).classList.add('active');
            
            document.querySelectorAll('.nav-btn').forEach(el => {
                el.classList.remove('text-milk-600', 'font-bold');
                el.classList.add('text-gray-400');
                el.querySelector('div').classList.remove('bg-milk-100');
            });
            const activeBtn = document.querySelector(`.nav-btn[data-target="tab-${tabId}"]`);
            if(activeBtn) {
                activeBtn.classList.remove('text-gray-400');
                activeBtn.classList.add('text-milk-600', 'font-bold');
                activeBtn.querySelector('div').classList.add('bg-milk-100');
            }
        }

        // --- Weather Widget Logic ---
        async function fetchOkinawaWeather() {
            const apiKey = '00000fc38af518206496ddcfb6d68fe1';
            const city = 'Naha,JP'; 
            const widget = document.getElementById('weather-widget');
            try {
                const response = await fetch(`https://api.openweathermap.org/data/2.5/weather?q=${city}&units=metric&lang=zh_tw&appid=${apiKey}`);
                if (!response.ok) throw new Error('Weather API Error');
                const data = await response.json();
                
                const temp = Math.round(data.main.temp);
                const desc = data.weather[0].description;
                const iconCode = data.weather[0].icon;
                const iconUrl = `https://openweathermap.org/img/wn/${iconCode}@2x.png`;

                widget.classList.remove('weather-loading');
                widget.classList.add('bg-white');
                widget.innerHTML = `
                    <img src="${iconUrl}" class="w-8 h-8 -ml-1 filter drop-shadow-sm" alt="icon">
                    <div class="flex flex-col leading-none pr-1">
                        <span class="text-[10px] text-gray-400 font-medium">é‚£éœ¸ç¾åœ¨</span>
                        <div class="flex items-center gap-1"><span class="text-lg font-bold text-milk-600">${temp}Â°</span><span class="text-xs text-milk-500">${desc}</span></div>
                    </div>`;
            } catch (error) {
                console.error(error);
                widget.classList.remove('weather-loading');
                widget.innerHTML = `<span class="text-xs text-red-400"><i class="fa-solid fa-triangle-exclamation"></i> æ°£è±¡æš«ç„¡æ³•é¡¯ç¤º</span>`;
            }
        }

        // --- Data Persistence Logic (The Magic!) ---
        const defaultChecklist = [
            { id: 1, text: "è­·ç…§ (æ•ˆæœŸ6å€‹æœˆä»¥ä¸Š)", done: false },
            { id: 2, text: "æ—¥å¹£ç¾é‡‘ / ä¿¡ç”¨å¡", done: false },
            { id: 3, text: "è¡Œå‹•é›»æº & å……é›»ç·š", done: false },
            { id: 4, text: "åœ‹éš›é§•ç…§ (è­¯æœ¬)", done: false },
        ];
        
        const defaultItinerary = [
            { id: 1, day: 1, time: "09:20", icon: "fa-plane", name: "æŠµé”é‚£éœ¸æ©Ÿå ´ (OKA)", location: "é‚£éœ¸æ©Ÿå ´", notes: "å…¥å¢ƒæ‰‹çºŒã€é ˜å–è¡Œæ" },
            { id: 2, day: 1, time: "10:30", icon: "fa-car-side", name: "é ˜å–ç§Ÿè»Š", location: "OTS ç§Ÿè»Š è‡¨ç©ºè±å´ç‡Ÿæ¥­æ‰€", notes: "æ­ä¹˜æ¥é§è»Šå‰å¾€ï¼Œæª¢æŸ¥è»Šæ³" },
            { id: 3, day: 1, time: "12:00", icon: "fa-utensils", name: "åˆé¤ï¼šé€šå ‚æ‹‰éºµ", location: "é€šå ‚æ‹‰éºµ å°ç¥¿æœ¬åº—", notes: "ç”·äººéºµ(è±šéª¨)ã€å¥³äººéºµ(é›æ¹¯)" },
            { id: 4, day: 1, time: "14:00", icon: "fa-bed", name: "é£¯åº— Check-in", location: "ç¾åœ‹æ‘", notes: "å¯„æ”¾è¡Œæï¼Œç¨ä½œä¼‘æ¯" },
        ];

        let checklist = JSON.parse(localStorage.getItem('trip_checklist')) || defaultChecklist;
        let itineraryItems = JSON.parse(localStorage.getItem('trip_itinerary')) || defaultItinerary;
        let expenses = JSON.parse(localStorage.getItem('trip_expenses')) || [];
        let currentRate = localStorage.getItem('trip_rate') || 0.22;

        function saveData(type) {
            if (type === 'checklist') localStorage.setItem('trip_checklist', JSON.stringify(checklist));
            if (type === 'itinerary') localStorage.setItem('trip_itinerary', JSON.stringify(itineraryItems));
            if (type === 'expenses') localStorage.setItem('trip_expenses', JSON.stringify(expenses));
            if (type === 'rate') localStorage.setItem('trip_rate', document.getElementById('rate-input').value);
        }

        // --- Checklist Logic ---
        function renderChecklist() {
            const container = document.getElementById('checklist-container');
            container.innerHTML = '';
            checklist.forEach(item => {
                const div = document.createElement('div');
                div.className = "flex items-center gap-3";
                div.innerHTML = `
                    <label class="relative flex items-center p-3 rounded-full cursor-pointer">
                        <input type="checkbox" class="peer relative h-5 w-5 cursor-pointer appearance-none rounded-md border border-milk-300 transition-all checked:border-milk-400 checked:bg-milk-400 custom-checkbox" ${item.done ? 'checked' : ''} onchange="toggleCheck(${item.id})">
                        <div class="pointer-events-none absolute top-2/4 left-2/4 -translate-y-2/4 -translate-x-2/4 text-white opacity-0 transition-opacity peer-checked:opacity-100">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-3.5 w-3.5" viewBox="0 0 20 20" fill="currentColor" stroke="currentColor" stroke-width="1"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path></svg>
                        </div>
                    </label>
                    <span class="text-sm font-medium ${item.done ? 'text-gray-400 line-through' : 'text-milk-900'} flex-1">${item.text}</span>
                    <button onclick="removeCheckitem(${item.id})" class="text-gray-300 hover:text-red-400 px-2"><i class="fa-solid fa-trash-can"></i></button>`;
                container.appendChild(div);
            });
        }

        function addChecklistItem() {
            const input = document.getElementById('checklist-input');
            const text = input.value.trim();
            if(text) {
                checklist.push({ id: Date.now(), text: text, done: false });
                input.value = '';
                saveData('checklist');
                renderChecklist();
            }
        }

        function toggleCheck(id) {
            const item = checklist.find(i => i.id === id);
            if(item) { item.done = !item.done; saveData('checklist'); renderChecklist(); }
        }

        function removeCheckitem(id) {
            checklist = checklist.filter(i => i.id !== id);
            saveData('checklist');
            renderChecklist();
        }

        // --- QR Code Logic ---
        function handleQrUpload(input) {
            if (input.files && input.files[0]) {
                var reader = new FileReader();
                reader.onload = function (e) {
                    const base64 = e.target.result;
                    document.getElementById('qr-image').src = base64;
                    document.getElementById('qr-preview').classList.remove('hidden');
                    // å˜—è©¦å„²å­˜ QR Code åˆ°æœ¬åœ° (æ³¨æ„ï¼šåœ–ç‰‡å¤ªå¤§å¯èƒ½æœƒè¶…é storage é™åˆ¶)
                    try { localStorage.setItem('trip_qr_img', base64); } catch(e) { console.log("Image too big to save"); }
                };
                reader.readAsDataURL(input.files[0]);
            }
        }
        function removeQr() {
            document.getElementById('qr-upload').value = "";
            document.getElementById('qr-preview').classList.add('hidden');
            localStorage.removeItem('trip_qr_img');
        }
        // Load Saved QR
        const savedQR = localStorage.getItem('trip_qr_img');
        if(savedQR) {
             document.getElementById('qr-image').src = savedQR;
             document.getElementById('qr-preview').classList.remove('hidden');
        }

        // --- Hotel Notes Logic ---
        function saveHotelNotes() {
            localStorage.setItem('trip_hotel_note_1', document.getElementById('hotel-note-1').value);
            localStorage.setItem('trip_hotel_note_2', document.getElementById('hotel-note-2').value);
        }
        // Load Saved Notes
        document.getElementById('hotel-note-1').value = localStorage.getItem('trip_hotel_note_1') || '';
        document.getElementById('hotel-note-2').value = localStorage.getItem('trip_hotel_note_2') || '';


        // --- Itinerary Logic ---
        let currentDay = 1;
        function filterDay(day) {
            currentDay = day;
            document.querySelectorAll('.day-filter').forEach(btn => {
                btn.classList.remove('active', 'bg-milk-400', 'text-white', 'shadow-md');
                btn.classList.add('bg-white', 'text-milk-500', 'border', 'border-milk-200');
            });
            const active = document.querySelector(`.day-filter[data-day="${day}"]`);
            active.classList.remove('bg-white', 'text-milk-500', 'border', 'border-milk-200');
            active.classList.add('active', 'bg-milk-400', 'text-white', 'shadow-md');
            renderItinerary();
        }

        function renderItinerary() {
            const container = document.getElementById('itinerary-list');
            const items = itineraryItems.filter(i => i.day === currentDay).sort((a,b) => a.time.localeCompare(b.time));
            container.innerHTML = `<div class="timeline-line"></div>`;
            if(items.length === 0) {
                container.innerHTML += `<div class="pl-12 pt-4 text-gray-400 text-sm italic">å°šç„¡è¡Œç¨‹å®‰æ’ï¼ŒæŒ‰ä¸Šæ–¹æŒ‰éˆ•æ–°å¢ï¼</div>`;
                return;
            }
            items.forEach(item => {
                const html = `
                <div class="relative pl-12 pb-6 group">
                    <div class="absolute left-0 top-0 w-10 h-10 bg-milk-400 rounded-full flex items-center justify-center z-10 shadow-md text-white border-4 border-milk-50">
                        <i class="fa-solid ${item.icon} text-sm"></i>
                    </div>
                    <div class="bg-white p-4 rounded-xl shadow-sm border border-milk-100 relative">
                        <div class="absolute top-3 right-3 flex gap-3 text-gray-300">
                             <a href="https://www.google.com/maps/search/?api=1&query=${item.location}" target="_blank" class="hover:text-milk-500 transition"><i class="fa-solid fa-map-location-dot"></i></a>
                             <button onclick="openItineraryModal('edit', ${item.id})" class="hover:text-milk-500 transition"><i class="fa-solid fa-pen-to-square"></i></button>
                             <button onclick="deleteItineraryItem(${item.id})" class="hover:text-red-400 transition"><i class="fa-solid fa-trash-can"></i></button>
                        </div>
                        <span class="font-bold text-milk-900 text-lg block mb-1">${item.time}</span>
                        <h4 class="font-bold text-milk-700 text-lg mb-2">${item.name}</h4>
                        ${item.notes ? `<div class="bg-milk-50 rounded-lg p-3 text-sm text-milk-900 border-l-4 border-milk-300"><span class="font-bold text-milk-400 text-xs block mb-1">**æ³¨æ„äº‹é …**</span>${item.notes}</div>` : ''}
                    </div>
                </div>`;
                container.innerHTML += html;
            });
        }

        function openItineraryModal(mode, id = null) {
            const modal = document.getElementById('itinerary-modal');
            const title = document.getElementById('modal-title');
            const submitBtn = document.getElementById('modal-submit-btn');
            modal.style.display = 'flex';
            setTimeout(() => modal.classList.remove('opacity-0', 'pointer-events-none'), 10);

            if (mode === 'edit' && id) {
                const item = itineraryItems.find(i => i.id === id);
                title.innerText = "ç·¨è¼¯è¡Œç¨‹";
                submitBtn.innerText = "æ›´æ–°";
                document.getElementById('itinerary-id').value = item.id;
                document.getElementById('itinerary-day').value = item.day;
                document.getElementById('item-name').value = item.name;
                document.getElementById('item-time').value = item.time;
                document.getElementById('item-location').value = item.location;
                document.getElementById('item-notes').value = item.notes;
                document.getElementById('item-icon').value = item.icon || 'fa-location-dot';
            } else {
                title.innerText = "æ–°å¢è¡Œç¨‹";
                submitBtn.innerText = "æ–°å¢";
                document.getElementById('itinerary-form').reset();
                document.getElementById('itinerary-id').value = ''; 
                document.getElementById('itinerary-day').value = currentDay;
                document.getElementById('item-time').value = "10:00";
            }
        }

        function closeItineraryModal() {
            const modal = document.getElementById('itinerary-modal');
            modal.classList.add('opacity-0', 'pointer-events-none');
            setTimeout(() => modal.style.display = 'none', 300);
        }

        document.getElementById('itinerary-form').addEventListener('submit', function(e) {
            e.preventDefault();
            const idVal = document.getElementById('itinerary-id').value;
            const isEdit = idVal !== '';
            
            const newItem = {
                id: isEdit ? parseInt(idVal) : Date.now(),
                day: parseInt(document.getElementById('itinerary-day').value),
                name: document.getElementById('item-name').value,
                time: document.getElementById('item-time').value,
                location: document.getElementById('item-location').value,
                notes: document.getElementById('item-notes').value,
                icon: document.getElementById('item-icon').value
            };

            if (isEdit) {
                const index = itineraryItems.findIndex(i => i.id === newItem.id);
                if(index !== -1) itineraryItems[index] = newItem;
            } else {
                itineraryItems.push(newItem);
            }
            saveData('itinerary');
            renderItinerary();
            closeItineraryModal();
        });

        function deleteItineraryItem(id) {
            if(confirm('ç¢ºå®šè¦åˆªé™¤é€™å€‹è¡Œç¨‹å—ï¼Ÿ')) {
                itineraryItems = itineraryItems.filter(i => i.id !== id);
                saveData('itinerary');
                renderItinerary();
            }
        }

        // --- Accounting Logic ---
        function saveRate() { saveData('rate'); }
        document.getElementById('rate-input').value = currentRate;

        function calculateRate(source) {
            const rate = parseFloat(document.getElementById('rate-input').value);
            const jpyInput = document.getElementById('jpy-input');
            const twdInput = document.getElementById('twd-input');
            if (source === 'jpy') {
                const jpy = parseFloat(jpyInput.value);
                if (!isNaN(jpy)) twdInput.value = Math.round(jpy * rate);
                else twdInput.value = '';
            } else {
                const jpy = parseFloat(jpyInput.value);
                if (!isNaN(jpy)) twdInput.value = Math.round(jpy * rate);
            }
        }

        function addExpense(e) {
            e.preventDefault();
            const name = document.getElementById('expense-name').value;
            const amount = parseFloat(document.getElementById('expense-amount-jpy').value);
            const category = document.getElementById('expense-category').value;
            if (name && amount) {
                expenses.unshift({ id: Date.now(), name: name, amountJPY: amount, category: category, date: new Date().toLocaleDateString() });
                document.getElementById('add-expense-form').reset();
                saveData('expenses');
                renderExpenseList();
                renderAccountingSummary();
            }
        }
        
        function deleteExpense(id) {
             if(confirm('ç¢ºå®šåˆªé™¤é€™ç­†èŠ±è²»ï¼Ÿ')) {
                expenses = expenses.filter(e => e.id !== id);
                saveData('expenses');
                renderExpenseList();
                renderAccountingSummary();
             }
        }

        function renderExpenseList() {
            const container = document.getElementById('expense-list-container');
            container.innerHTML = '';
            const rate = parseFloat(document.getElementById('rate-input').value);
            if(expenses.length === 0) {
                 container.innerHTML = `<div class="text-center text-gray-400 text-sm py-4">ç›®å‰æ²’æœ‰èŠ±è²»ç´€éŒ„</div>`;
                 return;
            }
            expenses.forEach(item => {
                const twd = Math.round(item.amountJPY * rate);
                const div = document.createElement('div');
                div.className = "bg-white p-4 rounded-xl shadow-sm border border-milk-100 flex justify-between items-center mb-3";
                div.innerHTML = `
                    <div class="flex items-center gap-3 flex-1">
                        <span class="text-xs font-bold text-white px-2 py-1 rounded bg-milk-400">${item.category}</span>
                        <div>
                            <p class="font-bold text-milk-900 text-sm">${item.name}</p>
                            <p class="text-[10px] text-gray-400">${item.date}</p>
                        </div>
                    </div>
                    <div class="flex items-center gap-4">
                        <div class="text-right">
                            <p class="font-bold text-milk-600">Â¥${item.amountJPY.toLocaleString()}</p>
                            <p class="text-xs text-gray-400">â‰ˆ NT$${twd.toLocaleString()}</p>
                        </div>
                        <button onclick="deleteExpense(${item.id})" class="text-gray-300 hover:text-red-400 transition px-2"><i class="fa-solid fa-trash-can"></i></button>
                    </div>`;
                container.appendChild(div);
            });
        }

        function renderAccountingSummary() {
            const rate = parseFloat(document.getElementById('rate-input').value);
            const totalJPY = expenses.reduce((sum, item) => sum + item.amountJPY, 0);
            const totalTWD = Math.round(totalJPY * rate);
            document.getElementById('total-jpy').innerText = `JPY ç¸½é¡: Â¥${totalJPY.toLocaleString()}`;
            document.getElementById('total-twd').innerText = `${totalTWD.toLocaleString()} TWD`;
        }
        
        // Reset Function (Hidden Easter Egg: Click '5 Days' badge to reset)
        function resetAllData() {
            if(confirm("è­¦å‘Šï¼šè¦é‡ç½®æ‰€æœ‰è³‡æ–™ä¸¦æ¢å¾©é è¨­å—ï¼Ÿé€™æœƒæ¸…é™¤æ‚¨æ‰€æœ‰çš„è¨˜å¸³å’Œè¡Œç¨‹ä¿®æ”¹ã€‚")) {
                localStorage.clear();
                location.reload();
            }
        }

        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            renderItinerary();
            fetchOkinawaWeather();
            renderExpenseList();
            renderAccountingSummary();
            renderChecklist();
        });
    </script>
</body>
</html>